<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Servicios</title>

    <!-- color de barra de direcciones -->
    <meta name="theme-color" content="#ff4500">
    <!-- navegador movil, sitio optimizado para movil y amistoso -->
    <meta name="MobileOptimized" content="width">
    <meta name="HandheldFriendly" content="true">

    <!-- apple -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <meta name="google-signin-scope" content="profile email">
    <meta name="google-signin-client_id" content="469995200100-d6e0f5vpvv0uafvk08i5vmbh4cjprk7f.apps.googleusercontent.com">
    <!-- <meta name="google-signin-client_id" content="469995200100-pb5u6gm98npq3tda1pvr49qgf4ug2dg7.apps.googleusercontent.com"> -->
    
    <script src="https://apis.google.com/js/platform.js" async defer></script>

    <!-- icono de la pagina -->
    <link rel="shortcut icon" type="image/png" href="./img/campana.png">

    <!-- icono de aplicacion en los dispositivos -->
    <link rel="apple-touch-icon" href="./img/campana.png">
    <!-- imagen de carga movil -->
    <link rel="apple-touch-startup-image" href="./img/campana.png">
    <link rel="manifest" href="./manifest.json">
    <link rel="stylesheet" href="./style.css">

    <!-- jQuery library -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

    <!-- materialize -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>

    <!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script> -->
    <!-- letras -->
    <link href="https://fonts.googleapis.com/css2?family=Jaldi&display=swap" rel="stylesheet">

    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
</head>
<body>
    <nav>
        <div class="nav-wrapper">
            <!-- <p class="title">BIENVENIDO</p> -->
            <a href="#" data-target="mobile-demo" class="sidenav-trigger"><i class="material-icons">menu</i></a>
            <ul id="nav-mobile" class="right">
            </ul>
        </div>
    </nav>

    <ul class="sidenav" id="mobile-demo">
        <li>
            <a class="modal-trigger" href="#modalSeleccionarInicioSesion">Iniciar Sesion</a>
        </li>
        <!-- <li><a id="iniciaSesionGoogle">Iniciar Sesion</a></li> -->
        <li><a >Cerrar Sesion</a></li>
        
    </ul>

    <section>
        <div class="input-field col s6">
            <input id="url" type="text" value="">
            <label for="url">Url de youtube</label>
        </div>
    </section>
    <section>
        <!-- <iframe id="iframe" width="100%" height="400rem" src="https://www.youtube.com/embed/WopbUeiJrdM" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe> -->
        <iframe id="iframe" width="100%" height="400rem" src="" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
    </section>
    
    <!-- <div id="fb-root"></div> -->

    <script async defer crossorigin="anonymous" src="https://connect.facebook.net/es_LA/sdk.js#xfbml=1&autoLogAppEvents=1&version=v7.0&appId=2493604780902683"></script>

    <!-- Modal Structure -->
    <div id="modalSeleccionarInicioSesion" class="modal bottom-sheet">
        <div class="modal-content">
            <div style="text-align: center" class="col s12 m12 l12 xl12">
                <div class="fb-login-button" data-size="medium" data-button-type="login_with" data-layout="default" data-auto-logout-link="false" data-use-continue-as="true" data-width=""></div>
            </div>
            <div style="text-align: center" class="col s12 m12 l12 xl12">
                <div class="g-signin2" data-onsuccess="onSignIn" data-theme="dark"></div>
            </div>
        </div>
        

        <!-- <div class="modal-footer"> -->
        <!-- <a href="#!" class="modal-close waves-effect waves-green btn-flat">Agree</a>
        </div> -->
    </div>

    <script src="./script.js"></script>
    <script src="./signin.js"></script>
</body>

<script>

    $(document).ready(function(){
        $('.modal').modal();
        $("#iframe").attr("src","https://www.youtube.com/embed/" + "_QjD7IJE3Es");
    });

    $("#url").on("change",()=>
    {
        var url = $("#url").val();
        var urlTemp = "";
        var urlF = "";
        if(url.includes("watch"))
        {
            urlTemp = url.split("list=");
        }
        else
        {
            urlTemp = url.split("/");
        }

        $.each(urlTemp,function(index,value)
        {
            urlF = value;
        });

        if(url.includes("watch"))
        {
            $("#iframe").attr("src","https://www.youtube.com/embed/videoseries?list=" + urlF);
            // $("#iframe").attr("src",url);
        }
        else
        {
            $("#iframe").attr("src","https://www.youtube.com/embed/" + urlF);
        }
        
    });

    var deferredPrompt;
    var btn_install;

// window.onload = function()

// function installPWA()
// $("#btn_install").on("click",()=>{

// {
// btnSave.addEventListener('click', function()
    function eventInstall()
{
    if(deferredPrompt !== undefined)
    {
        // The user has had a positive interaction with our app and Chrome
        // has tried to prompt previously, so let's show the prompt.
        deferredPrompt.prompt();

        // Follow what the user has done with the prompt.
        deferredPrompt.userChoice.then(function(choiceResult) {

        console.log(choiceResult.outcome);

        if(choiceResult.outcome == 'dismissed') {
            console.log('User cancelled home screen install');
        }
        else {
            console.log('User added to home screen');
        }

        // We no longer need the prompt.  Clear it up.
        deferredPrompt = null;
        });
    }
}
// });
    window.addEventListener('beforeinstallprompt', function(e)
{
    
    console.log('beforeinstallprompt Event fired');
    e.preventDefault();
    // Stash the event so it can be triggered later.
    deferredPrompt = e;
    if(btn_install==undefined)
    {
        btn_install = $("<a>");
        $(btn_install).append("<i class='material-icons'>file_download</i>");
        $(btn_install).on("click",()=>{eventInstall()});
        $("#nav-mobile").append(btn_install);
    }

    //   $("#nav-mobile").append("<li><a id='btn_install'><i class='material-icons'>file_download</i></a></li>");

  return false;
});

    $(document).ready(function()
    {
        $('.sidenav').sidenav();
    });

    $("#iniciaSesionGoogle").on("click",function()
    {
        $(".abcRioButtonContentWrapper").click();
    });
    
</script>
</html>